<!DOCTYPE html>
<!-- saved from url=(0087)https://wiki.archlinux.org/index.php/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87) -->
<html lang="en" dir="ltr" class="client-js" mode="normal"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Change root (简体中文) - ArchWiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"Change_root_(简体中文)","wgTitle":"Change root (简体中文)","wgCurRevisionId":429324,"wgRevisionId":429324,"wgArticleId":15525,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["System recovery (简体中文)"],"wgBreakFrames":!1,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Change_root_(简体中文)","wgRelevantArticleId":15525,"wgIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits"]);
} );</script>
<link rel="stylesheet" href="./Change root (简体中文) - ArchWiki_files/load.php">
<!--[if IE 6]><link rel="stylesheet" href="/skins/ArchLinux/IE60Fixes.css?303" media="screen"/><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/skins/ArchLinux/IE70Fixes.css?303" media="screen"/><![endif]-->
<style>
.mw-collapsible-toggle{float:right;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}  .mw-content-ltr .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr .mw-collapsible-toggle{float:right} .mw-content-rtl .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl .mw-collapsible-toggle{float:left}.mw-customtoggle,.mw-collapsible-toggle{cursor:pointer} caption .mw-collapsible-toggle,.mw-content-ltr caption .mw-collapsible-toggle,.mw-content-rtl caption .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr caption .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl caption .mw-collapsible-toggle{float:none} li .mw-collapsible-toggle,.mw-content-ltr li .mw-collapsible-toggle,.mw-content-rtl li .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr li .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl li .mw-collapsible-toggle{float:none} .mw-collapsible-toggle-li{list-style:none}
.suggestions{overflow:hidden;position:absolute;top:0;left:0;width:0;border:none;z-index:1099;padding:0;margin:-1px 0 0 0}.suggestions-special{position:relative;background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0;margin-top:-2px;display:none;padding:0.25em 0.25em;line-height:1.25em}.suggestions-results{background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0}.suggestions-result{color:black;margin:0;line-height:1.5em;padding:0.01em 0.25em;text-align:left; overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}.suggestions-result-current{background-color:#4C59A6;color:white}.suggestions-special .special-label{color:gray;text-align:left}.suggestions-special .special-query{color:black;font-style:italic;text-align:left}.suggestions-special .special-hover{background-color:silver}.suggestions-result-current .special-label,.suggestions-result-current .special-query{color:white}.highlight{font-weight:bold}
pre,.mw-code{white-space:pre} span.archwiki-template-pkg,span.archwiki-template-man{font-family:monospace} div.archwiki-template-message{position:relative;overflow:hidden; min-height:4.6em; margin-bottom:1em;background-color:#F9FAFF;border:1px solid #D7DFE3;padding:0 100px;text-align:center}div.archwiki-template-message > p > a{display:block;position:absolute;top:5px}div.archwiki-template-message > p > a:first-of-type{left:26px; }div.archwiki-template-message > p > a:last-of-type{right:26px; }div.archwiki-template-message > div{font-size:90%}div.archwiki-template-message ul,div.archwiki-template-message ol{text-align:left}
.mw-search-results{float:none} #bodyContent a.external[href],#bodyContent a.extiw,.link-https{background:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTMiIHdpZHRoPSIxMyIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPgo8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzYuNDY3ODA4LC0yNTguMzkwMDUpIj4KPHBhdGggc3R5bGU9Im9wYWNpdHk6MTtmaWxsOiMzMzY2YmI7IiBkPSJtNDEuNDcsMjU5LjQsNywwLDAsNy0yLTItMywyLDAtMSwzLTIuMjUsMSwxLDAtMy43NS0zLjc1LDAsMSwxLTIuMjUsMy0xLDAsMi0zeiIvPgo8cGF0aCBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6IzMzNjZiYjsiIGQ9Im00My40NywyNjEuNC01LDAsMCw4LDgsMCwwLTUtMSwwLDAsNC02LDAsMC02LDQsMHoiLz4KPHBhdGggc3R5bGU9Im9wYWNpdHk6MTtmaWxsOiMxNWE1ZWE7IiBkPSJtNDAuNTUsMjYzLjljMC0wLjYyMTMsMC42MjEzLTAuNjIxMywwLjYyMTMtMC42MjEzLDEuODY0LDAuNjIxMywzLjEwNywxLjg2NCwzLjcyOCwzLjcyOCwwLDAsMCwwLjYyMTMtMC42MjEzLDAuNjIxMy0xLjI0My0xLjg2NC0xLjg2NC0yLjQ4NS0zLjcyOC0zLjcyOHoiLz4KPC9nPgo8L3N2Zz4K) center right no-repeat;padding-right:13px} #bodyContent a.external[href ^="http://wiki.archlinux.org"],#bodyContent a.external[href ^="https://wiki.archlinux.org"]{background:none;padding-right:0} a:link,#toc a, #bodyContent #toc a,#p-cactions li a,#p-personal li a,#p-cactions li a:visited,#p-personal li a:visited,#bodyContent a.external,#bodyContent a.extiw{color:#07b}a:hover,#toc a:hover, #bodyContent #toc a:hover,#p-cactions li a:hover,#p-personal li a:hover,#p-cactions li a:visited:hover,#p-personal li a:visited:hover,#bodyContent a:hover.external,#bodyContent a:hover.extiw{color:#07b;text-decoration:underline}a:visited,#toc a:visited, #bodyContent #toc a:visited,#bodyContent a:visited.external,#bodyContent a:visited.extiw{color:#357}a:visited:hover,#toc a:visited:hover, #bodyContent #toc a:visited:hover,#bodyContent a:visited:hover.external,#bodyContent a:visited:hover.extiw{color:#357;text-decoration:underline}a:focus,a:active,#toc a:focus,#toc a:active, #bodyContent #toc a:focus,#bodyContent #toc a:active,#p-cactions li a:focus,#p-cactions li a:active,#p-personal li a:focus,#p-personal li a:active,#bodyContent a:focus.external,#bodyContent a:active.external,#bodyContent a:focus.extiw,#bodyContent a:active.extiw{color:#e90 !important}a.new,#p-cactions .new a,#p-personal a.new{color:#b00 !important} code,tt{ display:inline;white-space:pre;padding:0.3em}
.postedit-container{margin:0 auto;position:fixed;top:0;height:0;left:50%;z-index:1000;font-size:13px}.postedit-container:hover{cursor:pointer}.postedit{position:relative;top:0.6em;left:-50%;padding:.6em 3.6em .6em 1.1em;line-height:1.5625em;color:#626465;background-color:#f4f4f4;border:1px solid #dcd9d9;text-shadow:0 0.0625em 0 rgba(255,255,255,0.5);border-radius:5px;box-shadow:0 2px 5px 0 #ccc;-webkit-transition:all 0.25s ease-in-out;-moz-transition:all 0.25s ease-in-out;-ms-transition:all 0.25s ease-in-out;-o-transition:all 0.25s ease-in-out;transition:all 0.25s ease-in-out}.skin-monobook .postedit{top:6em !important}.postedit-faded{opacity:0}.postedit-icon{padding-left:41px;  line-height:25px;background-repeat:no-repeat;background-position:8px 50%}.postedit-icon-checkmark{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABblBMVEUAAAD///////9PfTf///80aRdTgjn///9Feij///////////9Rfzf///////////9PfjZRgDh1o1xOfTb///////+bwYqLtnj///////9PfTa82K////9WhT6YxIL///9QgDdTgzr////////j7uDl7eLq8efi693k7OH///////9UhjuBr2rp9uRUhjr///9YljVKgir///9WiTlYjT3////9/v57vFlbkT5PjC9dlD/5/fhuq09stUTs9uhxuElctCpfnT1huDFloEZloUZmpENmvDZpvDxpvTxqvjxrvT5rvT9rwTxsqktswD5uwkBvuUdxw0NztFBztU9ztVBzwkp0tlJ1xkd2t1R3uVR4w1F4xk54x014yE15uVZ5v1R5xVB6v1R7yFJ8wVh9xVl9yFR9yVd9ylN+xVh+yFd/x1l/yFeAylmEx1+Ny2uY0Hqe04Wj1Ymv3Ze33qLD47TJ5L3O6cPU7Mrq9eb2+/Q4j37OAAAAQHRSTlMAAQIEBAUFBQwPFB4fJCUoKiosQEhJS01RUlZZXmdydXaChYuSlJSWmJmoq6uur8LExcvM19fg5ejt8fX2+Pr7SljgewAAAKpJREFUGBkFwQNCAwAAAMDLtl3LtrG4rWXbtvX77gAgZ6grFwC0bhwNVgKgdPZx8b0dgLi+s7Wn0VoAqpfOI9+BNADZI7fLrz2pSEwGHZuH+78lSK8ZLkLezF3ooyUG3VPXq2USei9WngeyoG195yBYWDF3E/2pAhl1e9Gr8bGT+bfOFCC2fnvh4X7rcqIAQNNu+HT6sxkAjceTL/2ZAIhv+PorBwBJxfkA//dFHSCBy/UTAAAAAElFTkSuQmCC);background-image:url(/resources/src/mediawiki.action/images/green-checkmark.png?9048a)!ie;background-position:left}.postedit-close{position:absolute;padding:0 .8em;right:0;top:0;font-size:1.25em;font-weight:bold;line-height:2.3em;color:black;text-shadow:0 0.0625em 0 white;text-decoration:none;opacity:0.2;filter:alpha(opacity=20)}.postedit-close:hover{color:black;text-decoration:none;opacity:0.4;filter:alpha(opacity=40)}</style><style>
.suggestions a.mw-searchSuggest-link,.suggestions a.mw-searchSuggest-link:hover,.suggestions a.mw-searchSuggest-link:active,.suggestions a.mw-searchSuggest-link:focus{color:black;text-decoration:none}.suggestions-result-current a.mw-searchSuggest-link,.suggestions-result-current a.mw-searchSuggest-link:hover,.suggestions-result-current a.mw-searchSuggest-link:active,.suggestions-result-current a.mw-searchSuggest-link:focus{color:white}.suggestions a.mw-searchSuggest-link .special-query{ overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}</style><meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="./Change root (简体中文) - ArchWiki_files/load(1).php">
<style></style>
<script async="" src="./Change root (简体中文) - ArchWiki_files/load(2).php"></script><style id="night_mode">html[mode="night"] { -webkit-filter: contrast(47%) brightness(105%) invert(); }html[mode="night"] img, html[mode="night"] i span, html[mode="night"] i, html[mode="night"] video { -webkit-filter: invert(); }html[mode="night"][data-player-size="fullscreen"] .html5-video-container {-webkit-filter: invert();}html[mode="night"] object[type="application/x-shockwave-flash"], html[mode="night"] object[type="application/x-shockwave-flash"] { -webkit-filter: invert();  !important; }html[mode="night"] embed[type="application/x-shockwave-flash"], html[mode="night"] embed[type="application/x-shockwave-flash"] { -webkit-filter: invert();  !important; }</style>
<meta name="generator" content="MediaWiki 1.26.4">
<link rel="shortcut icon" href="https://wiki.archlinux.org/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="https://wiki.archlinux.org/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="https://wiki.archlinux.org/index.php?title=Special:RecentChanges&amp;feed=atom">
<script src="./Change root (简体中文) - ArchWiki_files/load(3).php"></script></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Change_root_简体中文 skin-archlinux action-view">

		<div id="archnavbar"><!-- Arch Linux global navigation bar -->
			<div id="archnavbarlogo">
				<p><a id="logo" href="https://www.archlinux.org/"></a></p>
			</div>
			<div id="archnavbarmenu">
				<ul id="archnavbarlist">
					<li id="anb-home"><a href="https://www.archlinux.org/">Home</a></li><li id="anb-packages"><a href="https://www.archlinux.org/packages/">Packages</a></li><li id="anb-forums"><a href="https://bbs.archlinux.org/">Forums</a></li><li id="anb-wiki" class="anb-selected"><a href="https://wiki.archlinux.org/">Wiki</a></li><li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li><li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li><li id="anb-download"><a href="https://www.archlinux.org/download/">Download</a></li>				</ul>
			</div>
		</div><!-- #archnavbar -->

		<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Change root (简体中文)</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From ArchWiki</div>
					<div id="contentSub"></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="https://wiki.archlinux.org/index.php/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#column-one">navigation</a>, <a href="https://wiki.archlinux.org/index.php/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;"><strong> 翻译状态： </strong>本文是英文页面 <a href="https://wiki.archlinux.org/index.php/Change_Root" title="Change Root" class="mw-redirect">Change_Root</a> 的<a href="https://wiki.archlinux.org/index.php/ArchWiki_Translation_Team_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="ArchWiki Translation Team (简体中文)">翻译</a>，最后翻译时间：2013-06-20，点击<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Change_Root&amp;diff=0&amp;oldid=261088">这里</a>可以查看翻译后英文页面的改动。</div>
<p><a href="https://en.wikipedia.org/wiki/Chroot" class="extiw" title="wikipedia:Chroot">Chroot</a> 是将当前磁盘根路径(和当前进程和它们的子进程)更改到另一个根目录。当你更改根路径到另一个目录下时，你不能在那个目录外存取文件和使用命令。这个目录叫作 <i>chroot jail</i>。切换根目录通常为了系统维护，例如重装引导程序或者重置遗忘的密码。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2><span class="toctoggle">&nbsp;[<a href="https://wiki.archlinux.org/index.php/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#" id="togglelink">hide</a>]&nbsp;</span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="https://wiki.archlinux.org/index.php/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#.E5.BF.85.E8.A6.81.E6.9D.A1.E4.BB.B6"><span class="tocnumber">1</span> <span class="toctext">必要条件</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="https://wiki.archlinux.org/index.php/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#.E6.8C.82.E8.BD.BD.E5.88.86.E5.8C.BA"><span class="tocnumber">2</span> <span class="toctext">挂载分区</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="https://wiki.archlinux.org/index.php/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#Change_root"><span class="tocnumber">3</span> <span class="toctext">Change root</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="https://wiki.archlinux.org/index.php/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#.E8.BF.90.E8.A1.8C.E5.9B.BE.E5.BD.A2.E5.8C.96.E7.9A.84chroot.E5.BA.94.E7.94.A8"><span class="tocnumber">4</span> <span class="toctext">运行图形化的chroot应用</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="https://wiki.archlinux.org/index.php/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#.E7.B3.BB.E7.BB.9F.E7.BB.B4.E6.8A.A4"><span class="tocnumber">5</span> <span class="toctext">系统维护</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="https://wiki.archlinux.org/index.php/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#.E9.80.80.E5.87.BAchroot.E7.8E.AF.E5.A2.83"><span class="tocnumber">6</span> <span class="toctext">退出chroot环境</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="https://wiki.archlinux.org/index.php/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#.E7.A4.BA.E4.BE.8B"><span class="tocnumber">7</span> <span class="toctext">示例</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id=".E5.BF.85.E8.A6.81.E6.9D.A1.E4.BB.B6">必要条件</span></h2>
<ul><li> 你需要从另一个运行的linux环境启动(例如从liveCD或USB闪存介质，或者从另一个已经安装的linux发行版中)。</li></ul>
<ul><li> 为了chroot需要root特权。</li></ul>
<ul><li> 确定你启动进的linux环境的架构符合你想要更改的根路径的架构(例如，i686,x86_64)。你可以用以下命令得到你的当前环境架构：</li></ul>
<dl><dd> <pre># uname -m</pre></dd></dl>
<ul><li> 如果你需要任何在chroot环境中使用的内核模块，在chroot之前加载它。初始化你的swap (<code>swapon /dev/sdxY</code>)估计也很有用，并且在chroot之前建立网络连接。</li></ul>
<h2><span class="mw-headline" id=".E6.8C.82.E8.BD.BD.E5.88.86.E5.8C.BA">挂载分区</span></h2>
<p>你想尝试chroot进去的linux系统根分区需要先被挂载。为了找出内核分配的设备名称，运行：
</p>
<pre># lsblk /dev/sda
</pre>
<p>你也能运行如下命令获取你的分区布局
</p>
<pre># fdisk -l
</pre>
<p>现在创建一个你想要挂载root分区的目录并且挂载到它：
</p>
<pre># mkdir /mnt/arch
# mount /dev/sda3 /mnt/arch
</pre>
<p>接着，如果你的系统的其它分区有单独分区(比如说 <code>/boot</code>， <code>/home</code>，<code>/var</code>等等)，你也需要挂载他们：
</p>
<pre># mount /dev/sda1 /mnt/arch/boot/
# mount /dev/sdb5 /mnt/arch/home/
# mount ...
</pre>
<p>尽管你chroot之后可以挂载文件系统，之前完事更加方便。原因就是你将不得不在退出chroot之前卸载临时文件系统，而这样做将让你用一个单个命令卸载所有文件系统。这也使得关机更加安全。因为外部linux环境知道所有挂载的分区，它能安全的在关机时卸载他们。
</p>
<h2><span class="mw-headline" id="Change_root">Change root</span></h2>
<p>作为root挂载临时文件系统：
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;"><strong> Note: </strong>使用更新的 (2012) Arch
<p>发行版，以下<code>mount</code>命令可以被<code>arch-chroot
</code></p><code>
/mnt/arch</code>取代。你必须安装了<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=arch-install-scripts">arch-install-scripts</a></span>才能运行arch-chroot。如果你在使用其它不同的Linux发行版以下命令应该仍可以使用。</div>
<pre># cd /mnt/arch
# mount -t proc proc proc/
# mount -t sysfs sys sys/
# mount -o bind /dev dev/
# mount -t devpts pts dev/pts/
</pre>
<p>如果你已经建立了一个网络连接并且想要在chroot环境中使用它，你可能不得不拷贝你的DNS服务器配置让你能够解析主机名：
</p>
<pre># cp -L /etc/resolv.conf etc/resolv.conf
</pre>
<p>现在chroot到你之前安装的系统中并且指定你的shell
</p>
<pre># chroot /mnt/arch /usr/bin/bash
</pre>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;"><strong> Note: </strong>如果你遇到错误 <code>chroot: cannot run command '/bin/bash': Exec format error</code>，很可能两个环境架构不匹配。</div>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;"><strong> Note: </strong>如果你遇到错误 <code>chroot: '/usr/bin/bash': permission
denied</code>,用执行权限重新挂载: <code>mount -o remount,exec /mnt/arch</code>。</div>
<p>可选地，source你的Bash配置文件(<code>~/.bashrc</code>和<code>/etc/bash.bashrc</code>)，运行：
</p>
<pre># source ~/.bashrc
# source /etc/profile
</pre>
<p>可选的，创建一个独特的提示符来区别你的chroot环境：
</p>
<pre># export PS1="(chroot) $PS1"
</pre>
<h2><span class="mw-headline" id=".E8.BF.90.E8.A1.8C.E5.9B.BE.E5.BD.A2.E5.8C.96.E7.9A.84chroot.E5.BA.94.E7.94.A8">运行图形化的chroot应用</span></h2>
<p>如果你在系统上运行了<a href="https://wiki.archlinux.org/index.php/X" title="X" class="mw-redirect">X</a>，你可以在chroot环境启动图形应用。
</p><p>为了chroot环境能连接到你的X服务器，在X服务器中打开一个终端(例如，在用户当前登录的桌面中)，然后运行如下命令给任何人连接到用户X服务器的权限：
</p>
<pre>$ xhost +
</pre>
<p>然后，从chroot环境中将应用指向你的X服务器，将chroot中的DISPLAY环境变量设定成和拥有X服务器的用户DISPLAY变量相匹配。例如，运行：
</p>
<pre>$ echo $DISPLAY
</pre>
<p>作为拥有X服务器的用户查看DISPLAY的值。如果是“:0”(例如是)，然后在chroot环境中运行
</p>
<pre># export DISPLAY=:0
</pre>
<p>现在你可以从chroot命令行启动图形界面应用;）
</p>
<h2><span class="mw-headline" id=".E7.B3.BB.E7.BB.9F.E7.BB.B4.E6.8A.A4">系统维护</span></h2>
<p>此时你可以执行任何你需要在chroot环境中执行的系统维护操作。一些常见的例子是：
</p>
<ul><li> 重装引导。</li>
<li> 重新构建<a href="https://wiki.archlinux.org/index.php/Mkinitcpio" title="Mkinitcpio">initramfs</a>镜像。</li>
<li> 升级或<a href="https://wiki.archlinux.org/index.php/Downgrading_packages_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="Downgrading packages (简体中文)">降级</a>软件包。</li>
<li> 重置<a href="https://wiki.archlinux.org/index.php/Password_Recovery_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="Password Recovery (简体中文)" class="mw-redirect">遗忘的密码</a>.</li></ul>
<h2><span class="mw-headline" id=".E9.80.80.E5.87.BAchroot.E7.8E.AF.E5.A2.83">退出chroot环境</span></h2>
<p>当你完成系统维护后，退出chroot：
</p>
<pre># exit
</pre>
<p>然后卸载临时文件系统和任何挂载的设备：
</p>
<pre># umount {proc,sys,dev/pts,boot,[...],}
</pre>
<p>最后，尝试卸载你的根分区：
</p>
<pre># cd ..
# umount arch/
</pre>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;"><strong> Note: </strong>如果你得到错误说<code>/mnt</code>(或其它任何分区) is busy, 这可能意味着两种情况：
<ul><li> chroot环境中残留了一个运行的程序。</li></ul>
<ul><li> 或者，更常见的是，仍然存在子挂载(例如 <code>/mnt/arch/boot</code>挂载在<code>/mnt/arch</code>)。通过<code>lsblk</code>检查是否还存在任何挂载点(你也可以单输入一个mount查看):</li></ul>
<dl><dd> <pre>lsblk /dev/sda</pre></dd></dl>
<dl><dd> 如果你仍然不能卸载分区，使用<code>--force</code>选项：</dd></dl>
<dl><dd> <pre># umount -f /mnt</pre></dd></dl></div>
<p>这之后，你可以安全地的重启了。
</p>
<h2><span class="mw-headline" id=".E7.A4.BA.E4.BE.8B">示例</span></h2>
<p>这也许能在浏览期间保护你的系统免于网络攻击：
</p>
<pre># # as root: 
# cd /home/user
# mkdir myroot
# pacman -S arch-install-scripts
# # pacstrap must see myroot as mounted: 
# mount --bind myroot myroot
# pacstrap -i myroot base base-devel
# mount -t proc proc myroot/proc/
# mount -t sysfs sys myroot/sys/
# mount -o bind /dev myroot/dev/
# mount -t devpts pts myroot/dev/pts/
# cp -i /etc/resolv.conf myroot/etc/
# chroot myroot
# # inside chroot: 
# passwd # set a password 
# useradd -m -s /usr/bin/bash user
# passwd user # set a password
# # in a shell outside the chroot: 
# pacman -S xorg-server-xnest
# # in a shell outside the chroot you can run this as user: 
$ Xnest -ac -geometry 1024x716+0+0&nbsp;:1
# # continue inside the chroot: 
# pacman -S xterm
# DISPLAY=:1
# xterm
# # xterm is now running in Xnest 
# pacman -S xorg-server xorg-xinit xorg-server-utils
# pacman -S openbox
# # for java we need icedtea-web which requires some fonts: 
# nano /etc/locale.gen
# # uncomment en_US.UTF-8 UTF-8, save and exit 
# locale-gen
# echo LANG=en_US.UTF-8 &gt; /etc/locale.conf
# export LANG=en_US.UTF-8
# pacman -S ttf-dejavu
# pacman -S icedtea-web
# pacman -S firefox
# firefox
# # firefox is now running in Xnest 
# exit
# # outside chroot: 
# chroot --userspec=user myroot
# # inside chroot as user: 
$ DISPLAY=:1
$ openbox &amp;
$ HOME="/home/user"
$ firefox</pre>
<p>参见: <a rel="nofollow" class="external text" href="https://help.ubuntu.com/community/BasicChroot">Basic Chroot</a>
</p>
<!-- 
NewPP limit report
Cached time: 20170104064102
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.010 seconds
Real time usage: 0.013 seconds
Preprocessor visited node count: 270/1000000
Preprocessor generated node count: 772/1000000
Post‐expand include size: 8667/2097152 bytes
Template argument size: 5939/2097152 bytes
Highest expansion depth: 8/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    9.154      1 - -total
 53.64%    4.910      5 - Template:META_Box_Blue
 45.79%    4.192      4 - Template:Note
 42.70%    3.908      5 - Template:META_Box
 26.50%    2.426      1 - Template:TranslationStatus_(简体中文)
 18.69%    1.711     16 - Template:Ic
 10.01%    0.916      4 - Template:Bc
  8.71%    0.797      1 - Template:Pkg
-->

<!-- Saved in parser cache with key archwiki:pcache:idhash:15525-0!*!0!!en!*!* and timestamp 20170104064102 and revision id 429324
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=429324">https://wiki.archlinux.org/index.php?title=Change_root_(简体中文)&amp;oldid=429324</a>"</div>
					<div id="catlinks" class="catlinks"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://wiki.archlinux.org/index.php/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="https://wiki.archlinux.org/index.php/Category:System_recovery_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="Category:System recovery (简体中文)">System recovery (简体中文)</a></li></ul></div></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-main" class="selected"><a href="https://wiki.archlinux.org/index.php/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="View the content page [alt-shift-c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="https://wiki.archlinux.org/index.php?title=Talk:Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [alt-shift-t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource"><a href="https://wiki.archlinux.org/index.php?title=Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit" title="This page is protected.
You can view its source [alt-shift-e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="https://wiki.archlinux.org/index.php?title=Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=history" title="Past revisions of this page [alt-shift-h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="https://wiki.archlinux.org/index.php?title=Special:UserLogin&amp;returnto=Change+root+%28%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="https://wiki.archlinux.org/index.php?title=Special:UserLogin&amp;returnto=Change+root+%28%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29" title="You are encouraged to log in; however, it is not mandatory [alt-shift-o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="https://wiki.archlinux.org/index.php/Main_page" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<h3>Navigation</h3>
		<div class="pBody">
							<ul>
											<li id="n-mainpage-description"><a href="https://wiki.archlinux.org/index.php/Main_page" title="Visit the main page [alt-shift-z]" accesskey="z">Main page</a></li>
											<li id="n-categories"><a href="https://wiki.archlinux.org/index.php/Table_of_contents">Categories</a></li>
											<li id="n-portal"><a href="https://wiki.archlinux.org/index.php/Getting_involved" title="Various ways Archers can contribute to the community">Getting involved</a></li>
											<li id="n-currentevents"><a href="https://wiki.archlinux.org/index.php/ArchWiki:News" title="The latest lowdown on the wiki">Wiki news</a></li>
											<li id="n-randompage"><a href="https://wiki.archlinux.org/index.php/Special:Random" title="Load a random page [alt-shift-x]" accesskey="x">Random page</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="https://wiki.archlinux.org/index.php" id="searchform">
					<input type="hidden" name="title" value="Special:Search">
					<input type="search" name="search" placeholder="Search" title="Search ArchWiki [alt-shift-f]" accesskey="f" id="searchInput" autocomplete="off">
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton">&nbsp;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton">
				</form>

							</div>
		</div>
		<div class="generated-sidebar portlet" id="p-interaction" role="navigation">
		<h3>interaction</h3>
		<div class="pBody">
							<ul>
											<li id="n-help"><a href="https://wiki.archlinux.org/index.php/Category:Help" title="Wiki navigation, reading, and editing help">Help</a></li>
											<li id="n-Contributing"><a href="https://wiki.archlinux.org/index.php/ArchWiki:Contributing">Contributing</a></li>
											<li id="n-recentchanges"><a href="https://wiki.archlinux.org/index.php/Special:RecentChanges" title="A list of recent changes in the wiki [alt-shift-r]" accesskey="r">Recent changes</a></li>
											<li id="n-Recent-talks"><a href="https://wiki.archlinux.org/index.php/Special:RecentChanges?namespace=0&amp;invert=1" rel="nofollow">Recent talks</a></li>
											<li id="n-newpages"><a href="https://wiki.archlinux.org/index.php/Special:NewPages">New pages</a></li>
											<li id="n-Statistics"><a href="https://wiki.archlinux.org/index.php/ArchWiki:Statistics">Statistics</a></li>
											<li id="n-Reports"><a href="https://wiki.archlinux.org/index.php/ArchWiki:Reports">Reports</a></li>
											<li id="n-Requests"><a href="https://wiki.archlinux.org/index.php/ArchWiki:Requests">Requests</a></li>
									</ul>
					</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="https://wiki.archlinux.org/index.php/Special:WhatLinksHere/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="A list of all wiki pages that link here [alt-shift-j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="https://wiki.archlinux.org/index.php/Special:RecentChangesLinked/Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="Recent changes in pages linked from this page [alt-shift-k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="https://wiki.archlinux.org/index.php/Special:SpecialPages" title="A list of all special pages [alt-shift-q]" accesskey="q">Special pages</a></li>
											<li id="t-print"><a href="https://wiki.archlinux.org/index.php?title=Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;printable=yes" rel="alternate" title="Printable version of this page [alt-shift-p]" accesskey="p">Printable version</a></li>
											<li id="t-permalink"><a href="https://wiki.archlinux.org/index.php?title=Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=429324" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="https://wiki.archlinux.org/index.php?title=Change_root_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=info" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
				<div id="p-lang" class="portlet" role="navigation">
				<h3>In other languages</h3>

				<div class="pBody">
					<ul>
													<li class="interlanguage-link interwiki-en"><a href="https://wiki.archlinux.org/index.php/Change_root" title="Change root – English" lang="en" hreflang="en">English</a></li>
													<li class="interlanguage-link interwiki-es"><a href="https://wiki.archlinux.org/index.php/Change_root_(Espa%C3%B1ol)" title="Change root – español" lang="es" hreflang="es">Español</a></li>
													<li class="interlanguage-link interwiki-fa"><a href="http://wiki.archusers.ir/index.php/%D8%AA%D8%BA%DB%8C%DB%8C%D8%B1_%D8%B1%DB%8C%D8%B4%D9%87" title="تغییر ریشه – فارسی" lang="fa" hreflang="fa">فارسی</a></li>
													<li class="interlanguage-link interwiki-fr"><a href="http://wiki.archlinux.fr/Chroot" title="Chroot – français" lang="fr" hreflang="fr">Français</a></li>
													<li class="interlanguage-link interwiki-ja"><a href="https://wiki.archlinuxjp.org/index.php/Change_Root" title="Change Root – 日本語" lang="ja" hreflang="ja">日本語</a></li>
													<li class="interlanguage-link interwiki-ro"><a href="http://wiki.archlinux.ro/index.php/Chroot" title="Chroot – română" lang="ro" hreflang="ro">Română</a></li>
													<li class="interlanguage-link interwiki-ru"><a href="https://wiki.archlinux.org/index.php/Change_root_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Change root – русский" lang="ru" hreflang="ru">Русский</a></li>
											</ul>

									</div>
			</div>
				</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<ul id="f-list">
									<li id="lastmod"> This page was last modified on 2 April 2016, at 14:03.</li>
									<li id="copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
									<li id="privacy"><a href="https://wiki.archlinux.org/index.php/ArchWiki:Privacy_policy" title="ArchWiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="https://wiki.archlinux.org/index.php/ArchWiki:About" title="ArchWiki:About">About ArchWiki</a></li>
									<li id="disclaimer"><a href="https://wiki.archlinux.org/index.php/ArchWiki:General_disclaimer" title="ArchWiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"]);
} );</script><script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgBackendResponseTime":26});
} );</script>

<div class="suggestions" style="display: none; font-size: 12px;"><div class="suggestions-results"></div><div class="suggestions-special"></div></div></body><!-- Cached/compressed 20170104064102 --></html>